# Discord Bot Ping 通知からレスポンス本文を除外し実行 URL を追加する

- ステータス: 承認済み
- 日付: 2025-09-03
- タグ: GitHub Actions, 通知, セキュリティ

技術ストーリー: Slack 通知に含める情報とトリガー条件を見直し、誤検知と情報漏えいリスクを減らす。

## 背景 / 文脈

過去に GitHub Actions の出力形式が原因で 200 OK でも `failure()` が発火し、不要なエラー通知が発生していた。通知本文にレスポンスペイロードを含めていたため、機微情報が漏れる懸念と可読性の低下も指摘されていた。

## 決定ドライバ

- Slack 通知に機微情報を載せたくない。
- 実行結果の詳細を追跡するためには GitHub Actions の Run URL が有用。
- 通知は失敗時のみ発火し、成功時は過剰なメッセージを避けたい。

## 検討した選択肢

1. レスポンス本文を通知から除外し、Run URL を追加する（採択）。
2. レスポンス本文をマスクした上で概要のみ通知する。
3. 現状維持で通知内容を変更しない。

## 決定（採択）

通知からレスポンス本文を除外し、GitHub Actions の Run URL を追加する。通知条件は非 200 ステータスまたはリクエスト失敗時に限定する。

## 影響評価

### ポジティブな影響

- Slack への機微情報露出リスクを低減できる。
- 通知内容が簡潔になり、Run URL から詳細を追跡しやすい。

### ネガティブな影響

- 即時にレスポンス本文を確認したい場合は Run URL へ遷移する手間がかかる。

## その他検討事項

- レスポンス本文をマスクする案は実装コストが増え、ズレが残る可能性があった。
- 現状維持では過去の誤検知や情報露出リスクが解決しない。
